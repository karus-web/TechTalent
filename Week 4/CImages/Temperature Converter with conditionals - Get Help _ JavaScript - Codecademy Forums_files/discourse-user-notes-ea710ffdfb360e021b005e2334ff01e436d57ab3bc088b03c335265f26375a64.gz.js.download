define("discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/admin-user-controls-after/add-user-notes-button",["exports","discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/user-profile-controls/show-notes-on-profile"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s=t.default
e.default=s})),define("discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/after-reviewable-post-user/show-user-notes-on-flags",["exports","I18n","discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes","discourse-common/lib/get-owner","discourse/lib/text","@ember/object"],(function(e,t,s,o,r,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var i={shouldRender:(e,t)=>t.siteSettings.user_notes_enabled&&e.user,setupComponent(e,s){const o=n.default.create(e.user).get("custom_fields.user_notes_count")||0
s.setProperties({userNotesCount:o,emojiEnabled:s.siteSettings.enable_emoji,emojiUrl:(0,r.emojiUrlFor)("pencil"),userNotesTitle:t.default.t("user_notes.show",{count:o})})},actions:{showUserNotes(){const e=(0,o.getOwner)(this).lookup("service:store"),t=this.get("args.user");(0,s.showUserNotes)(e,t.id,(e=>this.set("userNotesCount",e)))}}}
e.default=i})),define("discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/user-card-post-names/show-user-notes-on-card",["exports","I18n","discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes","discourse-common/lib/get-owner","discourse/lib/text"],(function(e,t,s,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var n={shouldRender(e,t){const{siteSettings:s,currentUser:o}=t
return s.user_notes_enabled&&o&&o.staff},setupComponent(e,s){const{user:o}=e,n=o.user_notes_count||o.get("custom_fields.user_notes_count")||0
s.setProperties({userNotesCount:n,emojiEnabled:s.siteSettings.enable_emoji,emojiUrl:(0,r.emojiUrlFor)("pencil"),userNotesTitle:t.default.t("user_notes.show",{count:n})})},actions:{showUserNotes(){this.parentView.parentView._close()
const e=(0,o.getOwner)(this).lookup("service:store"),t=this.get("args.user");(0,s.showUserNotes)(e,t.id,(e=>{this.isDestroying||this.isDestroyed||this.set("userNotesCount",e)}))}}}
e.default=n})),define("discourse/plugins/discourse-user-notes/discourse-user-notes/connectors/user-profile-controls/show-notes-on-profile",["exports","discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes","discourse-common/lib/get-owner"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var o={shouldRender(e,t){const{siteSettings:s,currentUser:o}=t
return s.user_notes_enabled&&o&&o.staff},setupComponent(e,t){const{model:s}=e
t.set("userNotesCount",s.user_notes_count||s.get("custom_fields.user_notes_count")||0)},actions:{showUserNotes(){const e=(0,s.getOwner)(this).lookup("service:store"),o=this.get("args.model");(0,t.showUserNotes)(e,o.id,(e=>this.set("userNotesCount",e)))}}}
e.default=o})),define("discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes",["exports","discourse/lib/show-modal"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.showUserNotes=function(e,s,o,r){return r=r||{},e.find("user-note",{user_id:s}).then((e=>{const n=(0,t.default)("user-notes",{model:e,title:"user_notes.title",addModalBodyView:!0})
return n.reset(),n.setProperties({userId:s,callback:o,postId:r.postId}),n}))}})),define("discourse/plugins/discourse-user-notes/discourse-user-notes/templates/connectors/admin-user-controls-after/add-user-notes-button",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s=(0,t.createTemplateFactory)({id:"+/WUADYE",block:'[[[8,[39,0],null,[["@show","@count"],[[28,[37,1],[[30,0],"showUserNotes"],null],[30,0,["userNotesCount"]]]],null],[1,"\\n"]],[],false,["show-user-notes","action"]]',moduleName:"discourse/plugins/discourse-user-notes/discourse-user-notes/templates/connectors/admin-user-controls-after/add-user-notes-button.hbs",isStrictMode:!1})
e.default=s})),define("discourse/plugins/discourse-user-notes/discourse-user-notes/templates/connectors/after-reviewable-post-user/show-user-notes-on-flags",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s=(0,t.createTemplateFactory)({id:"ore6rDJx",block:'[[[41,[33,1],[[[1,"  "],[8,[39,2],null,[["@class","@translatedTitle","@action"],["btn btn-flat",[99,3,["@translatedTitle"]],[28,[37,4],[[30,0],"showUserNotes"],null]]],[["default"],[[[[1,"\\n"],[41,[33,5],[[[1,"      "],[10,"img"],[15,"src",[36,6]],[15,"title",[36,3]],[14,"alt","pencil"],[14,0,"emoji"],[12],[13],[1,"\\n"]],[]],[[[1,"      "],[1,[28,[35,7],["sticky-note"],null]],[1,"\\n"]],[]]],[1,"  "]],[]]]]],[1,"\\n"]],[]],null]],[],false,["if","userNotesCount","d-button","userNotesTitle","action","emojiEnabled","emojiUrl","d-icon"]]',moduleName:"discourse/plugins/discourse-user-notes/discourse-user-notes/templates/connectors/after-reviewable-post-user/show-user-notes-on-flags.hbs",isStrictMode:!1})
e.default=s})),define("discourse/plugins/discourse-user-notes/discourse-user-notes/templates/connectors/user-card-post-names/show-user-notes-on-card",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s=(0,t.createTemplateFactory)({id:"qTmo93Pa",block:'[[[41,[33,1],[[[1,"  "],[8,[39,2],null,[["@class","@translatedTitle","@action"],["btn btn-flat",[99,3,["@translatedTitle"]],[28,[37,4],[[30,0],"showUserNotes"],null]]],[["default"],[[[[1,"\\n"],[41,[33,5],[[[1,"      "],[10,"img"],[15,"src",[36,6]],[15,"title",[36,3]],[14,"alt","pencil"],[14,0,"emoji"],[12],[13],[1,"\\n"]],[]],[[[1,"      "],[1,[28,[35,7],["sticky-note"],null]],[1,"\\n"]],[]]],[1,"  "]],[]]]]],[1,"\\n"]],[]],null]],[],false,["if","userNotesCount","d-button","userNotesTitle","action","emojiEnabled","emojiUrl","d-icon"]]',moduleName:"discourse/plugins/discourse-user-notes/discourse-user-notes/templates/connectors/user-card-post-names/show-user-notes-on-card.hbs",isStrictMode:!1})
e.default=s})),define("discourse/plugins/discourse-user-notes/discourse-user-notes/templates/connectors/user-profile-controls/show-notes-on-profile",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s=(0,t.createTemplateFactory)({id:"lS82YkdD",block:'[[[8,[39,0],null,[["@show","@count"],[[28,[37,1],[[30,0],"showUserNotes"],null],[30,0,["userNotesCount"]]]],null],[1,"\\n"]],[],false,["show-user-notes","action"]]',moduleName:"discourse/plugins/discourse-user-notes/discourse-user-notes/templates/connectors/user-profile-controls/show-notes-on-profile.hbs",isStrictMode:!1})
e.default=s})),define("discourse/plugins/discourse-user-notes/discourse/adapters/user-note",["exports","discourse/adapters/rest","discourse/lib/ajax"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var o=t.default.extend({destroyRecord(e,t,o){const r=this.pathFor(e,t,o.id)
return(0,s.ajax)("".concat(r,"?user_id=").concat(o.user_id),{method:"DELETE"})}})
e.default=o})),define("discourse/plugins/discourse-user-notes/discourse/components/show-user-notes",["exports","@ember/component","@ember/template-factory","@glimmer/component","I18n"],(function(e,t,s,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,s.createTemplateFactory)({id:"0LgmM6rB",block:'[[[8,[39,0],null,[["@class","@action","@icon","@translatedLabel"],["btn btn-default",[30,1],"pencil-alt",[30,0,["label"]]]],null],[1,"\\n"]],["@show"],false,["d-button"]]',moduleName:"discourse/plugins/discourse-user-notes/discourse/components/show-user-notes.hbs",isStrictMode:!1})
class i extends o.default{get label(){return this.args.count>0?r.default.t("user_notes.show",{count:this.args.count}):r.default.t("user_notes.title")}}e.default=i,(0,t.setComponentTemplate)(n,i)})),define("discourse/plugins/discourse-user-notes/discourse/controllers/user-notes",["exports","@ember/controller","I18n","@ember/object","@ember/service","discourse/lib/ajax-error","@glimmer/tracking"],(function(e,t,s,o,r,n,i){"use strict"
var u,l,a,c,d,p
function f(e,t,s,o){s&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(o):void 0})}function m(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function b(e,t,s){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance")
return s}function h(e,t,s,o,r){var n={}
return Object.keys(o).forEach((function(e){n[e]=o[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=s.slice().reverse().reduce((function(s,o){return o(e,t,s)||s}),n),r&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(r):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
let g=(p=new WeakSet,u=class extends t.default{constructor(){super(...arguments),m(this,p),f(this,"dialog",l,this),f(this,"newNote",a,this),f(this,"userId",c,this),f(this,"saving",d,this)}reset(){this.newNote=null,this.userId=null,this.callback=null,this.saving=!1}get attachDisabled(){return this.saving||!this.newNote||0===this.newNote.length}attachNote(){const e=this.store.createRecord("user-note"),t=parseInt(this.userId,10)
this.saving=!0
const s={raw:this.newNote,user_id:t}
this.postId&&(s.post_id=parseInt(this.postId,10)),e.save(s).then((()=>{this.newNote="",this.model.insertAt(0,e),b(this,p,_).call(this)})).catch(n.popupAjaxError).finally((()=>this.saving=!1))}removeNote(e){this.dialog.deleteConfirm({message:s.default.t("user_notes.delete_confirm"),didConfirm:()=>{e.destroyRecord().then((()=>{this.model.removeObject(e),b(this,p,_).call(this)})).catch(n.popupAjaxError)}})}},l=h(u.prototype,"dialog",[r.inject],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=h(u.prototype,"newNote",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=h(u.prototype,"userId",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=h(u.prototype,"saving",[i.tracked],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h(u.prototype,"attachNote",[o.action],Object.getOwnPropertyDescriptor(u.prototype,"attachNote"),u.prototype),h(u.prototype,"removeNote",[o.action],Object.getOwnPropertyDescriptor(u.prototype,"removeNote"),u.prototype),u)
function _(){this.callback&&this.callback(this.model.length)}e.default=g})),define("discourse/plugins/discourse-user-notes/discourse/initializers/enable-user-notes",["exports","discourse/lib/plugin-api","discourse-common/lib/icon-library","discourse/plugins/discourse-user-notes/discourse-user-notes/lib/user-notes","discourse-common/utils/decorators"],(function(e,t,s,o,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var n={name:"enable-user-notes",initialize(e){const n=e.lookup("site-settings:main"),i=e.lookup("current-user:main")
if(!n.user_notes_enabled||!i||!i.staff)return
const u=e.lookup("service:store");(0,t.withPluginApi)("0.8.15",(e=>{var t,i,l,a,c,d,p,f,m,b
function h(){(0,o.showUserNotes)(u,this.attrs.user_id,(e=>{this.sendWidgetAction("refreshUserNotes",e)}),{postId:this.attrs.id})}e.attachWidgetAction("post","refreshUserNotes",(function(e){const t=this.model.user_custom_fields||{}
t.user_notes_count=e,this.model.set("user_custom_fields",t)})),e.modifyClass("controller:user",(t=(0,r.on)("init"),i=(0,r.observes)("model"),c=l={pluginId:"discourse-user-notes",userNotesCount:null,_modelChanged:function(){this.set("userNotesCount",this.get("model.custom_fields.user_notes_count")||0)},actions:{showUserNotes(){(0,o.showUserNotes)(u,this.model.id,(e=>this.set("userNotesCount",e)))}}},d="_modelChanged",p=[t,i],a=(a=Object.getOwnPropertyDescriptor(l,"_modelChanged"))?a.value:void 0,f={enumerable:!0,configurable:!0,writable:!0,initializer:function(){return a}},m=l,b={},Object.keys(f).forEach((function(e){b[e]=f[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=p.slice().reverse().reduce((function(e,t){return t(c,d,e)||e}),b),m&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(m):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(c,d,b),b=null),l))
const g=e.container.lookup("site:main").mobileView?"before":"after"
e.decorateWidget("poster-name:".concat(g),(e=>{if(e.widget.settings.hideNotes)return
return(e.attrs.userCustomFields||{}).user_notes_count>0?e.attach("user-notes-icon"):void 0})),e.decorateWidget("post-avatar:after",(e=>{if(!e.widget.settings.showNotes)return
return(e.attrs.userCustomFields||{}).user_notes_count>0?e.attach("user-notes-icon"):void 0})),e.decorateWidget("post-admin-menu:after",(e=>e.h("ul",e.attach("post-admin-menu-button",{icon:"pencil-alt",label:"user_notes.attach",action:"showUserNotes",secondaryAction:"closeAdminMenu",className:"add-user-note"})))),e.attachWidgetAction("post","showUserNotes",h),e.createWidget("user-notes-icon",{tagName:"span.user-notes-icon",click:h,html(){return n.enable_emoji?this.attach("emoji",{name:"pencil"}):(0,s.iconNode)("sticky-note")}})}))}}
e.default=n})),define("discourse/plugins/discourse-user-notes/discourse/templates/connectors/admin-dashboard-moderation-bottom/recent-user-notes-report-table",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s=(0,t.createTemplateFactory)({id:"WlETn3gI",block:'[[[41,[33,1,["user_notes_enabled"]],[[[1,"  "],[8,[39,2],null,[["@dataSourceName","@filters"],["user_notes",[30,0,["args","filters"]]]],null],[1,"\\n"]],[]],null]],[],false,["if","siteSettings","admin-report"]]',moduleName:"discourse/plugins/discourse-user-notes/discourse/templates/connectors/admin-dashboard-moderation-bottom/recent-user-notes-report-table.hbs",isStrictMode:!1})
e.default=s})),define("discourse/plugins/discourse-user-notes/discourse/templates/modal/user-notes",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
var s=(0,t.createTemplateFactory)({id:"DCTFrvMk",block:'[[[8,[39,0],null,[["@class"],["user-notes-modal"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,[["@value"],[[30,0,["newNote"]]]],null],[1,"  "],[8,[39,2],null,[["@action","@label","@class","@disabled"],[[28,[37,3],[[30,0],"attachNote"],null],"user_notes.attach","btn-primary",[30,0,["attachDisabled"]]]],null],[1,"\\n\\n"],[42,[28,[37,5],[[28,[37,5],[[33,6]],null]],null],null,[[[1,"    "],[10,0],[14,0,"user-note"],[12],[1,"\\n      "],[10,0],[14,0,"posted-by"],[12],[1,"\\n        "],[8,[39,7],null,[["@user"],[[30,1,["created_by"]]]],[["default"],[[[[1,"\\n          "],[1,[28,[35,8],[[30,1,["created_by"]]],[["imageSize"],["small"]]]],[1,"\\n        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n      "],[10,0],[14,0,"note-contents"],[12],[1,"\\n        "],[10,0],[14,0,"note-info"],[12],[1,"\\n          "],[10,1],[14,0,"username"],[12],[1,[30,1,["created_by","username"]]],[13],[1,"\\n          "],[10,1],[14,0,"post-date"],[12],[1,[28,[35,9],[[30,1,["created_at"]]],null]],[13],[1,"\\n\\n"],[41,[30,1,["can_delete"]],[[[1,"            "],[10,1],[14,0,"controls"],[12],[1,"\\n              "],[8,[39,2],null,[["@action","@icon","@class","@title"],[[28,[37,3],[[30,0],"removeNote",[30,1]],null],"far-trash-alt","btn-small btn-danger","user_notes.remove"]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"cooked"],[12],[1,"\\n          "],[1,[28,[35,11],[[30,1,["raw"]]],null]],[1,"\\n        "],[13],[1,"\\n\\n"],[41,[30,1,["post_id"]],[[[1,"          "],[10,3],[15,6,[30,1,["post_url"]]],[14,0,"btn btn-small"],[12],[1,"\\n            "],[1,[28,[35,12],["user_notes.show_post"],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"clearfix"],[12],[13],[1,"\\n    "],[13],[1,"\\n"]],[1]],null]],[]]]]],[1,"\\n"]],["n"],false,["d-modal-body","textarea","d-button","action","each","-track-array","model","user-link","avatar","age-with-tooltip","if","cook-text","i18n"]]',moduleName:"discourse/plugins/discourse-user-notes/discourse/templates/modal/user-notes.hbs",isStrictMode:!1})
e.default=s}))

//# sourceMappingURL=discourse-user-notes-23089c6d7b8bf52574826c23e2ec9e0b7ed2fce0b42328fd9c2b3350caf63f26.map
//!

;
